<script type="text/template" id="search-results-container-template" >
    	<div class="headerinformation" ></div> 
    	<div class="results" ></div> 
</script>

<script type="text/template" id="search-results-loadmore-template" >
    <div id="loadMoreContainer" >
        <div id="loadMore" >+</div>
    </div> 
</script>

<script type="text/template" id="hostresult-container-template" >
    <div class="articleContainer"  >
	<div class="hostContent"></div>
	<div class="footer"> 	
		<div class="hostResultontainer-more" style="display:none" >display all results (<span class="resultNumber" >1</span>) from <span class="hostName" ></span>
		</div> 
	</div>
    </div> 
</script>

<script type="text/template" id="search-result-template" >   
      <div class="resultcontainer hostResultontainer hostContent"  >
 	<div class="resultcontainerhost" > <i>{{= result.host }}</i> </div>
	<div class="resultcontainerdate" > <i>{{= result.post_date }}</i> </div>
	{{ if (result.customRelevance > 1) { }}
	<div class="resultcontainerimage" > <img src="{{= result.image }}" width="166" alt="image" ></img> </div>
	{{ } }}
        <div class="resultcontainertitle" ><a href="{{= result.url }}" > {{= result.title }} </a></div>
	{{ if (result.image != null) { }}
	<div class="resultcontainerimage" > <img src="{{= result.image }}" width="166" alt="image" ></img> </div>
	{{ } }}
	<div class="resultcontainerscore" > <i>{{= result.score }}</i> </div>
	<div class="resultcontainerinfo"><div class="resultcontainerinfonode resultcontainerinfonode_updatepending" urlref="{{= result.url }}" ></div></div>
	<div class="resultcontaineraction"><div class="recommend" sourceid="{{= result.ID }}" >recommend</div></div>
        <!--<div class="resultcontainerlink" >{{= result.url }}</div>-->
	<div class="resultcontainerhightlight" >{{= result.highlight }}</div>	
      </div>
</script>

<script type="text/template" id="search-results-news-template" >
	<div class="newstemplatecontent" >      	
		<div class="newstitle" >{{= node.name }}</div>
		<div class="newscontent" >{{= node.comment }}</div>
		<div class="newsurls" >
		<div> Check out these urls : </div>
			{{ _.each(node.associatedUrls, function(url) { }}
			<div>{{= url }}</div>
			{{ }); }} 
		</div>
</script>

<script type="text/javascript" >
var search_manager = null;
var ressource_manager = null;
$(function (){
	_.templateSettings = {
    		interpolate: /\{\{\=(.+?)\}\}/g,
    		evaluate: /\{\{(.+?)\}\}/g
	};
	search_manager = new searchManager('resultsContainer');	
	ressourcenode_manager = new ressourceNodesManager();
	//ressourcenode_manager.getCurrentRessourceNode();
	//search_manager.on(search_manager.UPDATEUI_COMPLETE, ressourcenode_manager.updateRessourceDisplayed, ressourcenode_manager);

	var query = getUrlVars()['q'];
	if (query != null && query != undefined)
	{
		$('#searchInput').val(query);
		search_manager.search(query);
	}

	$('#backLabel').click(function (){
		$('#resultsContainer').html('');
		$('#newsContainer').show();
		$('#searchInput').val('');		
		$('#backLabel').hide();
	});

	$('#startSearch').click(function (){
		$('#resultsContainer').show();
		$('#newsContainer').hide();
		$('#backLabel').show();
		query = $('#searchInput').val();		 
		search_manager.search(query);
	});

	
});

function getUrlVars()
{
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    for(var i = 0; i < hashes.length; i++)
    {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
}

$(document).ready(function(){
    $('#searchInput').bind('keypress',pressed);
});

function pressed(e)
{
    if(e.keyCode === 13)
    {
        $('#resultsContainer').show();
	$('#newsContainer').hide();
	$('#backLabel').show();
	query = $('#searchInput').val();		 
	search_manager.search(query);
        //put button.click() here
    }
}
</script>
<div class="header" ><div class="title" >global knowledge</div>
</div>

<div class="subheader" >

<div class="subheadercontent" >

<div class="subtitle" ></div>


	<input id="searchInput"></input> <div class="look" id="startSearch" >Take a look</div><div id="backLabel" style='display:none;' >Back to news</div>



<div class="headerright" >
<div class="headeraction" > ? </div><div class="headeraction" > share content </div></div></div></div>

<div class="maincontent" >
	<div id='newsContainer' class="news" >
		<div class="newslabel" > Currently : </div>
		<div class="newscontent" >
			


		</div>	
	</div>
	<div id="resultsContainer" style="display:none;">	
	</div>
	<!--<div class="search-content" >
		<div id="searchContainer">
			<input id="searchInput"></input>
		</div> 
		<div id="resultsContainer">		
		</div> 
		<div id="loadMore" style="display:none;" >Load More Results</div>
	</div>-->
</div>
<div class="footer" > <div class='basicfooter' > Contact | powered by Rails </div> </div>
